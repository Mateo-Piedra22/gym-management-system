{% extends "base.html" %}
{% block content %}
<div class="max-w-2xl mx-auto">
  {% if warnings and warnings|length %}
  <div class="rounded-md border border-red-700 bg-red-600/20 text-red-200 p-4">
    <div class="font-semibold">Warnings</div>
    <ul class="list-disc pl-5 mt-2">
      {% for w in warnings %}<li>{{ w }}</li>{% endfor %}
    </ul>
  </div>
  {% endif %}
  <h1 class="text-2xl font-semibold">Panel Admin</h1>
  <div class="mt-3">
    <a href="/admin/login" class="px-3 py-2 rounded-md bg-gray-900">Cambiar cuenta</a>
  </div>
  <h2 class="text-lg mt-6">Crear gimnasio</h2>
  <div class="text-sm text-gray-400 mt-1">Los campos marcados con * son obligatorios</div>
  <form id="create-form" method="post" action="/admin/gyms" class="grid gap-3 mt-3">
    <label class="grid gap-1">
      <span class="text-sm text-gray-300">Nombre *</span>
      <input id="create-name" name="nombre" placeholder="Nombre" required class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" />
    </label>
    <label class="grid gap-1">
      <span class="text-sm text-gray-300">Subdominio (opcional)</span>
      <div class="flex items-center gap-2">
        <input id="create-sub" name="subdominio" placeholder="Subdominio (opcional)" pattern="^[a-z0-9-]{1,63}$" title="Solo letras minúsculas, números y guiones" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950"
               hx-get="/admin/subdomains/check" hx-trigger="input changed" hx-target="#create-sub-status" hx-include="#create-name, #create-sub-hidden"
               x-on:input="document.getElementById('create-sub-hidden').value = $event.target.value" />
        <input type="hidden" id="create-sub-hidden" name="sub" />
        <span id="create-sub-status" class="text-xs text-gray-400"></span>
      </div>
    </label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">Teléfono dueño (opcional)</span><input name="owner_phone" placeholder="+54..." pattern="^\+?[0-9]{7,15}$" inputmode="tel" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">WhatsApp Phone ID (opcional)</span><input name="whatsapp_phone_id" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">WhatsApp Access Token (opcional)</span><input name="whatsapp_access_token" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">WhatsApp Business Account ID (opcional)</span><input name="whatsapp_business_account_id" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">WhatsApp Verify Token (opcional)</span><input name="whatsapp_verify_token" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">WhatsApp App Secret (opcional)</span><input name="whatsapp_app_secret" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <label class="flex items-center gap-2"><input type="checkbox" name="whatsapp_nonblocking" value="true"/><span class="text-sm">WhatsApp no bloqueante</span></label>
    <label class="grid gap-1"><span class="text-sm text-gray-300">Timeout envío WhatsApp (seg) (opcional)</span><input type="number" min="1" step="0.1" name="whatsapp_send_timeout_seconds" class="px-3 py-2 rounded-md border border-gray-700 bg-gray-950" /></label>
    <button type="submit" class="px-3 py-2 rounded-md bg-primary text-primary-foreground">Crear gimnasio</button>
  </form>
  <div class="mt-4 flex flex-wrap gap-3">
    <a href="/admin/audit?ui=1" class="px-3 py-2 rounded-md bg-gray-900">Auditoría</a>
    <a href="/admin/dashboard?ui=1" class="px-3 py-2 rounded-md bg-gray-900">Dashboard</a>
    <form method="post" action="/admin/sessions/invalidate" class="inline"><button type="submit" class="px-3 py-2 rounded-md bg-red-600 text-white">Invalidar sesiones</button></form>
  </div>
</div>
{% endblock %}